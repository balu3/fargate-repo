{
   "AWSTemplateFormatVersion":"2010-09-09",
   "Parameters":{
      "Tag":{
         "Type":"String",
         "Default":"latest"
      },
      "DesiredCount":{
         "Type":"Number",
         "Default":1
      },
      "Cluster":{
         "Type":"String",
         "Default":"fargate-uat"
      },
      "Repository":{
         "Type":"String",
         "Default":"fargate-ecr"
      }
   },
   "Resources":{
      "Service":{
         "Type":"AWS::ECS::Service",
         "Properties":{
            "Cluster":{
               "Ref":"Cluster"
            },
            "DesiredCount":{
               "Ref":"DesiredCount"
            },
            "LoadBalancers":[
               {
                  "ContainerName":"fargate-container",
                  "ContainerPort":"8088",
                  "TargetGroupArn":"arn:aws:elasticloadbalancing:ap-south-1:374553884378:targetgroup/fargate-targat-1/710c7b3ce115afab"
               }
            ],
            "TaskDefinition":{
               "Ref":"TaskDefinition1"
            },
            "LaunchType":"FARGATE",
            "NetworkConfiguration":{
               "AwsvpcConfiguration":{
                  "AssignPublicIp":"ENABLED",
                  "SecurityGroups":[
                     "sg-04e68843fd5378edb"
                  ],
                  "Subnets":[
                     "subnet-0c8277669ff8ff0ec",
                     "subnet-0dcaa7a3c7f0a23f9"
                  ]
               }
            }
         }
      },
      "TaskDefinition1":{
         "Type":"AWS::ECS::TaskDefinition",
         "Properties":{
            "RequiresCompatibilities":[
               "EC2",
               "FARGATE"
            ],
            "NetworkMode":"awsvpc",
            "Cpu":"256",
            "ExecutionRoleArn":"arn:aws:iam::374553884378:role/ecsTaskExecutionRole",
            "TaskRoleArn":"arn:aws:iam::374553884378:role/ecsTaskExecutionRole",
            "Memory":"512",
	    "Family":"fargate-cf-stack-TaskDefinition1-EHWLYKDG42OQ"
            "ContainerDefinitions":[
               {
                  "Name":"fargate-container",
                  "Image":"374553884378.dkr.ecr.ap-south-1.amazonaws.com/fargate-ecr:latest",
                  "PortMappings":[
                     {
                        "ContainerPort":"8088",
                        "HostPort":"8088"
                     }
                  ],
                  "Essential":"true"
               }
            ]
         }
      }
   }
}
